require(fmsb)
require(scales)

col <- c(
  "Génotypes", "Couleur", "TAVP", "Anthocyanes", "Composés Phénoliques Totaux",
  "Acidité Totale", "Acide Malique", "Delta C13","pH", "Poids (200 baies)", "Potassium","Azote assimilable","Acide tartrique","Sucre", "Maturité technologique"
)

data <- setNames(data.frame(matrix(ncol = 15, nrow = 0)), col)


r1 <- c("01",	"rouge",	13.9,	1.38,	13.74,	3.07,	0.7,	-22.27,	3.49,	271,	1790,	174,	7.03,	234,	76.22149837)
r2 <- c("02",	"rouge",	13.4,	2.88,	17.11,	3.11,	1.5,	-23.68,	3.46,	247,	1752,	121,	5.9,	225,	72.34726688)
r3 <- c("03",	"rouge",	13.6,	0.8,	6.56,	3.09,	1.1,	-24.23,	3.48,	524,	1776,	156,	6.42,	229,	74.11003236)
r4 <- c("04",	"rouge",	14.6,	1.85,	15.51,	3.65,	2,	-23,	3.51,	326,	2025,	142,	6.66,	245,	67.12328767)  
r5 <- c("05",	"blanc",	13.45,	NA,	NA,	2.48,	0.75,	-23.055,	3.36,	429,	1280,	107.5,	4.97,	226.5,	91.33064516)
r6 <- c("06",	"blanc",	14,	NA,	NA,	2.695,	0.65,	-24.15,	3.33,	495,	1333,	91.5,	5.21,	235.5,	87.38404453)
r7 <- c("07",	"rouge",	13.4,	1.17,	9.6,	3.68,	2.4,	-24.36,	3.49,	326,	1953,	125,	6.23,	225,	61.14130435)
r8 <- c("08",	"rouge",	14.4,	1.82,	16.98,	4.4,	1.7,	-24.24,	3.38,	321,	1826,	165,	7.69,	243,	55.22727273)
r9 <- c("09",	"rouge",	13.95,	1.31,	12.64,	2.625,	1.55,	-24.345,	3.455,	431,	1555,	132.5,	4.645, 235.5, 89.71428571)  
r10 <- c("10",	"rouge",	14.2,	2.43,	16.34,	3.32,	1.4,	-22.77,	3.57,	232,	2017,	200,	6.91,	239,	71.98795181)
r11 <- c("11",	"rouge",	13.4,	1.81,	16.86,	3.14,	1.4,	-23.68,	3.54,	261,	1992,	156,	6.53,	225,	71.65605096)
r12 <- c("12",	"rouge",	14.35,	0.95,	7.1,	3.03,	1.6,	-23.4,	3.44,	513,	1638.5,	143,	5.235,	241.5,	79.7029703)
r13 <- c("13",	"rouge",	13.3,	0.88,	8.81,	3.5,	2.2,	-24.12,	3.55,	412,	2221,	116,	6.32,	224,	64)
r14 <- c("14",	"blanc",	13.6,	NA,	NA,	2.925,	1.85,	-24.335,	3.435,	590,	1648,	123.5,	5.17,	228.5,	78.11965812)
r15 <- c("15",	"rouge",	13.3,	2.65,	17.53,	3.37,	1,	-23.9,	3.45,	335,	1798,	120,	7.05,	224,	66.46884273)
r16 <- c("16",	"rouge",	13.4,	1.67,	13.77,	3.195,	1.2,	-24.37,	3.4,	376,	1689,	82.5,	6.115,	225.5,	70.57902973)
r17 <- c("17",	"rouge",	14.05,	1.05,	10.79,	3.42,	1.65,	-23.895,	3.455,	439,	1986,	95,	6.02,	237,	69.29824561)
r18 <- c("18",	"rouge",	13.3,	1.39,	7.81,	3.36,	1.25,	-23.905,	3.375,	477,	1669,	88,	6.525,	223.5,	66.51785714)
r19 <- c("19",	"blanc",	13.1,	NA,	NA,	2.69,	0.7,	-23.85,	3.46,	351,	1711,	94,	6.17,	220,	81.78438662)
r20 <- c("20",	"rouge",	13.4,	1.45,	12.05,	3.57,	1.7,	-23.36,	3.5,	341,	1960,	196,	7.15,	226,	63.30532213)
r21 <- c("21",	"rouge",	13.3,	0.94,	9.06,	4.66,	3,	-25.29,	3.36,	492,	1870,	102,	6.91,	224,	48.06866953)
r22 <- c("22",	"rouge",	14,	1.01,	9.37,	2.82,	1.5,	-23.01,	3.57,	404,	2032,	159,	6.21,	235,	83.33333333)
r23 <- c("23",	"rouge",	13.6,	1.03,	9.06,	2.5533,	1.2333,	-26.6266,	3.3833,	520,	1590,	70.333,	4.6633,	229,	89.68668407)
r24 <- c("24",	"rouge",	13,	1.18,	11.27,	2.94,	0.8,	-23.77,	3.43,	370,	1685,	120,	6.55,	219,	74.48979592)
r25 <- c("25",	"rouge",	14,	1.15,	8.91,	3.27,	2.2,	-24.39,	3.51,	473,	1992,	92,	5.69,	235,	71.86544343)
r26 <- c("26",	"blanc",	13.1,	NA,	NA,	2.49,	1,	-24.41,	3.45,	657,	1610,	108,	5.06,	220,	88.35341365)
r27 <- c("27",	"rouge",	14.7,	2.68,	17.38,	4.31,	1.9,	-23.83,	3.38,	354,	1885,	101,	7.42,	247,	57.30858469)
r28 <- c("28",	"rouge",	13.5,	0.74,	7.39,	3.5,	1.2,	-22.71,	3.47,	314,	1911,	145,	7.4,	228,	65.14285714)
r29 <- c("TGre",	"rouge",	13.75,	1.09,	10.05,	2.515,	0.75,	-23.395,	3.435,	443,	1557,	102.5,	5.385,	232,	92.24652087)
r30 <- c("TSyr",	"rouge",	13.45,	1.14,	11.2,	3.46,	2.1,	-24.49,	3.55,	319,	2294,	113.5,	6.62,	226.5,	65.46242775)

  
data <- rbind(data, r1,r2,r3,r4,r5,r6,r7,r8,r9,r10,r11,r12,r13,r14,r15,r16,r17,r18,r19,r20,r21,r22,r23,r24,r25,r26,r27,r28,r29,r30)
colnames(data) <- col
row.names(data) <- data$Génotypes

 data <- data[,-c(1,2)]
 for (i in 1:13) {
   data[,i] <- as.numeric(data[,i])
 }
 
 
 data[is.na(data)] <- 0
 
 for (i in 1:13) {
   data[,i] <- rescale(data[,i], to = c(0,100) )
 }
 
 data <-rbind(rep(100,13) , rep(0,13) , data)
 
for (i in 3:32) {
  radarchart(data[c(1,2,i),]  , axistype=1 , plwd=2 , cglcol="grey", cglty=1, pcol=rgb(0.2,0.5,0.5,0.9) , pfcol=rgb(0.2,0.5,0.5,0.5) ,axislabcol="grey", caxislabels=seq(0,100,25), cglwd=0.8,vlcex=0.8, title = paste0("Génotype ", row.names(data)[i]))
}

 radarchart(data[c(1,2,3,31),]  , axistype=1 , plwd=2 , cglcol="grey", cglty=1, pcol=rgb(0.2,0.5,0.5,0.9) , pfcol=rgb(0.2,0.5,0.5,0.5) ,axislabcol="grey", caxislabels=seq(0,100,25), cglwd=0.8,vlcex=0.8, title = paste0("Génotype ", row.names(data)[i]))
 